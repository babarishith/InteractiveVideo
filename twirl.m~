function [x1,y1] = twirl(x, y,ang,rmax)
    dx = double(x - ci);
    dy = double(y - cj);
    r = sqrt(dx^2 + dy^2);
    angle = ang*pi/180;
    b = atan2(dy, dx) + angle;
    if r <= rmax 
        x1 = uint16(ci + r*cos(b));
        y1 = uint16(cj + r*sin(b));
    else
        x1 = x; y1 =y;
    end
end